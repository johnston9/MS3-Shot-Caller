{% extends "base.html" %}
{% block content %}

    <!--top-box with red "Shot Caller" sides decoration-->
    <div class="row">
    
        <div class="col s1 offset-s1 m1 offset-m3">
            <div class="long-boxl">
                <p>S<br>H<br>O<br>T</p>
            </div>
        </div>
    
        <div class="col s6 offset-s1 m4">
            <div class="login-box">
                <div class="row">
                    <div class="col s1 left-pad">
                        <div class="smallPanel-l"></div>
                    </div>
                    <div class="col s11">
                        <p class="username shadow-light1 center-align"><strong>{{ dep}}</strong></p>
                    </div>
                </div>
            </div>
        </div>
    
        <div class="col s1 offset-s1 m1">
            <div class="long-box right">
                <p>C<br>A<br>L<br>L<br>E<br>R</p>
            </div>
        </div>
    </div>
    
    <!--panel-left-->
    <div class="row">
        <div class="col s1">
            <div class="panel-left"></div>
        </div>
    
        <div class="col s10">
    
            <!--find message form-->
            <div class="row margintop-50">
                <div class="col top-box s10 offset-s1 m6 offset-m3">
                    <form class="" method="POST" action="{{ url_for('get_dep', dep=dep) }}">
                        <div class="input-field">
                            <i class="fas fa-fas fa-calendar-alt prefix light-blue-text text-darken-4"></i>
                            <input id="date" name="date" type="text" class="datepicker validate" required>
                            <label for="date">Pick Date</label>
                            <div class="center-align">
                                <button type="submit" class="btn-small light-blue darken-4 text-shadow">
                                    Find Message
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
    
            <!--find all messages-->
            <div class="row margintop-20">
                <div class="col s4 center-align">
                    <p class="center-align find">
                        <a class="link-color" href="{{ url_for('get_all', dep=dep) }}">
                            Find All Messages <i class="fas fa-angle-right"></i>
                        </a>
                    </p>
                </div>
    
                <!--Add Message-->
                <div class="col s4">
                    <p class="center-align find">
                        <a class="link-color" href="{{ url_for('add_message') }}">
                            Add Message <i class="fas fa-angle-right"></i>
                        </a>
                    </p>
                </div>
    
                <!--Find by Poster-->
                <div class="col s4 center-align">
                    <p class="center-align find">
                        <a class="link-color" href="{{ url_for('get_poster', dep=dep) }}">
                            Find by Poster <i class="fas fa-angle-right"></i>
                        </a>
                    </p>
                </div>
    
            </div>
    
            <h5 class="center-align antiquewhite">{{ day }}</h5>

            <!--messages-->
            <ul class="collapsible margintop-20 collapsible-border">
                {% for message in depart %}
                <li>
                    <div class="collapsible-header matt-black offwhite">
                        <i class="fas fa-caret-down"></i>
                        <strong>from ----- {{ message.poster }}</strong> ----- {{ message.job_title }} ----- SUBJECT -
                        {{ message.subject }}
                        ------- {% if message.is_priority == "on" %}
                        <i class="fas fa-exclamation-circle aqua tooltipped" data-position="right"
                            data-tooltip="PRIORITY!"></i>
                        {% endif %}
                    </div>
                    <div class="collapsible-body matt-black offwhite">
                        <p class="center-align">{{ message.message }}</p>
    
                        <!-- Message image-->
                        {% if message.image_src %}
                        <div class="row margintop-20">
                            <div class="col s12 m8 offset-m2">
                                <div class="message-pic">
                                    <img class="center-align margintop-20" src=" {{ message.image_src }} "
                                        alt="{{ message.image_name }}">
                                    <p> {{ message.image_name }} </p>
                                </div>
    
                            </div>
                        </div>
                        {% endif %}
                        <p class="center-align">
    
                        <!--Message date-->
                        {{ message.date }}</p>
    
                        <!--edit/delete-->
                        {% if session.user|lower == message.username|lower %}
                        <p>
                            <a href="{{ url_for('edit_message', depart=message.dept_name, message_id=message._id) }}"
                                class="btn-small blueBack-sea">
                                Edit <i class="fas fa-pen-fancy"></i></a>
    
                            <button data-target="modal{{ loop.index }}"
                                class=" right blueBack-sea btn modal-trigger">Delete</button>
    
                        <!-- Modal Structure -->
                        <div id="modal{{ loop.index }}" class="modal">
                            <div class="modal-content">
                                <h5 class="crimson">Are you sure you want to delete this message?</h5>
                            </div>
                            <div class="modal-footer">
                                <a href="{{ url_for('delete_message', depart=message.dept_name, message_id=message._id) }}"
                                    class="modal-close waves-effect waves-green btn-flat">OK</a>
                                <a href="#" class="modal-close waves-effect waves-green btn-flat">No</a>
                            </div>
                        </div>
                        </p>
    
                        {% endif %}
    
                    </div>
                </li>
    
                {% endfor %}
            </ul>
        </div>
    
        <!--panel right-->
        <div class="col s1">
            <div class="panel-right"></div>
        </div>
    
    </div>

{% endblock %}